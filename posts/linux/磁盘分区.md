---
title: 磁盘分区
category:
  - linux
tag:
  - Linux
---

# 磁盘分区

> 简单学习磁盘分区是什么，如何使用，常用的命令有哪些

##### 1. lsblk (List Block Devices) 命令解释：

```
1. NAME：块设备名称。
2. SIZE：块设备的容量大小。
3. TYPE：块设备类型，如磁盘（disk）或分区（part）。
4. MOUNTPOINT：设备被挂载的挂载点。
5. MODEL：硬件设备的制造商及型号。
6. FSTYPE：文件系统类型，比如ext4或NTFS。
7. UUID：块设备的唯一标识符。
8. LABEL：块设备的卷标或文件系统标签。
9. RO：块设备是否为只读。
10. RM：块设备是否可以通过软件进行移除。
11. PARTTYPE：如果块设备是分区，则该字段会显示分区类型。
12. PARTLABEL：如果块设备是分区，则该字段会显示分区卷标或文件系统标签。
13. PARTUUID：如果块设备是分区，则该字段会显示分区的唯一标识符。

这些指标可以帮助用户了解系统上的块设备，包括设备名称、容量、挂载点、文件系统类型等，从而更好地管理和使用系统。

[root@k8s-master network-scripts]# lsblk
NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
sr0     11:0    1 203.6M  0 rom  
vda    253:0    0    60G  0 disk 
└─vda1 253:1    0    60G  0 part /
```

##### 2. lsblk的MAJ:MIN和 TYPE为rom 是什么意思

``` txt
lsblk命令显示的输出中
MAJ:MIN表示设备的主设备号和次设备号
主设备号用于识别驱动程序，而次设备号用于识别设备本身

TYPE为rom表示设备是只读设备
ROM是只读存储器（Read-Only Memory）的简称
它存储的数据无法被写入
```

##### 3. 如何使用fdisk查看分区

``` bash
# 查看磁盘分区
$ fdisk -l

# 查看某一个磁盘下面的分区
$ fdisk -l /dev/sda
```

##### 4. 如何使用fdisk创建分区

``` bash
# 下面演示: Linux 系统中创建一个 ext4 文件系统格式的、挂载在 /mnt/mydisk 目录下的分区了

# 查看当前的磁盘以及磁盘下的分区
$ lsblk

# 输入 m 命令，查看 fdisk 的命令帮助信息，了解可以使用的命令。
# 输入 n 命令，创建一个新的分区，按照提示输入分区号、起始扇区和结束扇区等信息。
# 输入 t 命令，修改分区类型，例如将分区类型修改为 Linux 文件系统（83）。
# 输入 w 命令，保存并退出 fdisk 工具
# 开始对/sda做分区 ,注意/dev/sda是必须存在的磁盘设备
$ fdisk /dev/sda

# 使用 mkfs 命令格式化创建的分区
$ mkfs.ext4 /dev/sda1

# 在系统中挂载分区
# 将新分区 /dev/sda1 挂载到 /mnt/mydisk
# 这样可以通过 /mnt/mydisk 访问到分区
$ mkdir /mnt/mydisk
$ mount /dev/sda1 /mnt/mydisk
```

##### 5. /mnt是干嘛用的

```
/mnt 是一个挂载点，用于挂载外部设备（如硬盘、USB 等）到文件系统中的目录。
通常，挂载点为 /mnt，但也可以在其他位置创建挂载点。在 Linux 中，MNT 表示挂载点（mount point）的缩写。
```

##### 6. mkfs.ext4是什么意思

``` 
mkfs.ext4是一个Linux命令，用于创建ext4文件系统。
"mkfs"代表"make file system"
"ext4"是第四个扩展文件系统（Extended File System）的缩写
是Linux中最常见的文件系统之一

使用mkfs.ext4命令可以对磁盘分区进行格式化，以便在该分区上创建文件系统并存储数据。
```


##### 7. mount /dev/sda1 /mnt/mydisk是什么意思

这是一个Linux命令，用于将设备/dev/sda1（通常是硬盘分区）挂载（mount）到/mnt/mydisk目录中。
"mount"表示将一个文件系统连接到文件系统树的一个指定位置上
将磁盘分区挂载到一个目录中，可以使得该目录下面的文件和文件夹与该分区中的内容相对应。
在这个例子中，/dev/sda1分区上的数据将可以在/mnt/mydisk目录下访问。注意，要挂载一个设备
该设备必须首先被格式化并创建了文件系统，可以使用mkfs命令创建文件系统。


##### 8. pvcreate /dev/sdb 是什么意思

这个命令是Linux下用来创建物理卷（Physical Volume）的。具体来说：

- /dev/sdb 是要创建物理卷的设备文件。
- 在运行pvcreate命令之前，这个设备文件必须是未被分区的空闲磁盘或分区。
- 执行pvcreate后，该设备文件会被初始化为一个物理卷，然后可以将其添加到卷组（Volume Group）中，以供逻辑卷（Logical Volume）使用。

##### 9. dd if=/dev/zero of=/dev/sdb bs=1M count=1024

dd是Unix或类Unix系统中的命令，用于复制文件、转换格式、创建空文件和磁盘映像等操作。它是“数据块（Data Definition）”的缩写，因为它是以固定大小的数据块为单位操作数据的。在Linux系统中，dd命令也被广泛用于备份和还原硬盘，制作启动盘和光盘等操作。
该命令表示在 /dev/sdb 这个硬盘上创建一个大小为 1G 的空白文件。其中 if 表示输入文件，也就是要写入 /dev/sdb 的数据来源，这里设置为 /dev/zero，表示读取 0。of 表示输出文件，也就是写入 /dev/sdb 的数据目的地。bs 表示块大小，这里设置为 1M，表示每次写入 1MB 的数据。count 表示写入的块数，这里设置为 1024，表示一共写入 1024 个块，也就是 1G 的大小。这个命令也称作 dd 零填充，会在硬盘对应的设备文件中写入 0，用来清空硬盘数据。

#### 10. linux上的空白文件是什么意思

空白文件是一种大小为零的文件。它们通常用于占据磁盘空间或作为占位符，例如在创建一个空目录时用作占位符文件。
使用dd命令创建空白文件可以更精确地控制文件的大小和位置，并且可以在复制或克隆磁盘映像时使用。
例如，可以使用dd命令创建一个特定大小的空白文件，并将其用作虚拟磁盘的镜像文件。这种方法经常用于创建虚拟机硬盘映像或备份数据。

##### 11. 什么叫已经给/dev/sdb划分了分区，不能不能作为物理卷使用，物理卷和分区是什么意思

在Linux下，物理卷（Physical Volume）和分区（Partition）是两个不同的概念。
- 分区是指将一个磁盘或存储设备分成若干个大小不同的区域，每个分区可以独立地格式化、挂载和使用。
- 物理卷是将一个或多个分区或磁盘组合成一个卷组（Volume Group），并对其进行格式化，以提供更灵活的存储管理方式。
如果对/dev/sdb进行分区，那么这个设备就不能作为一个物理卷使用。如果想要将其作为物理卷，需要先执行删除分区的操作，然后使用pvcreate命令将其初始化为一个物理卷。
需要注意的是，一般情况下，一个物理卷不能超过硬件限制的容量，而一个分区则可以。因此，使用物理卷可以更灵活地管理不同硬件设备、不同容量的存储资源。

#### 12. linux的LVM是什么意思

逻辑卷管理器（Logical Volume Manager）的简称。
LVM通过虚拟化磁盘空间，将多个硬盘分区或物理磁盘组合成一个逻辑卷，并允许管理员在运行时动态地调整这些逻辑卷的大小。
在LVM中，管理员可以创建两个主要的逻辑卷
- 物理卷（Physical Volume）
- 卷组（Volume Group）
物理卷是指物理磁盘或分区，而卷组是将一个或多个物理卷组合在一起的逻辑单元。
LVM提供了更好的磁盘空间管理和灵活性，使管理员可以更好地满足服务器和存储的需求。LVM也广泛用于虚拟化环境中，以便在虚拟机之间动态分配磁盘空间。

### 13. df -h是什么，怎么看

df -h是一条Linux命令，用于显示文件系统磁盘使用情况的简明报告。
其中“-h”选项指定以人类可读的方式输出数据，即以可读性较高的GB、MB、KB等单位显示文件系统使用情况。

通过运行df -h命令，可以查看文件系统磁盘使用情况的报告，
包括：文件系统名称、文件系统大小、已用空间、可用空间、使用率、挂载点等信息。按照默认顺序，该命令显示磁盘使用情况信息的单位是KB。
例如，下面是一条示例命令及输出结果：

```
$ df -h
文件系统           容量  已用  可用 已用% 挂载点
udev             3.9G     0  3.9G    0% /dev
tmpfs            798M  1.7M  797M    1% /run
tmpfs            3.9G  159M  3.8G    4% /dev/shm
tmpfs            5.0M  4.0K  5.0M    1% /run/lock
tmpfs            3.9G     0  3.9G    0% /sys/fs/cgroup
/dev/sda1         15G  6.9G  7.3G   49% /
/dev/sda2        193G   77G  106G   42% /data
```

tmpfs的形式挂载，特定的目录比如/tmp、/var/run、/dev/shm等的都是内存文件系统


从上面的输出结果可以看出：该系统一共有5个文件系统，
其中/dev/sda1和/dev/sda2是已经挂载的硬盘分区，其它3个是内存文件系统。

其中，/dev/sda1分区总容量为15G，已经使用了6.9G，还剩7.3G可用空间，使用率为49%；
而/dev/sda2分区总容量为193G，已经使用了77G，还剩106G可用空间，使用率为42%。


### 14. fdisk /dev/vda的扇区是什么意思

### 15. linux 如何使用fdisk对一个磁盘分区
使用 fdisk 命令，可以对 Linux 系统的磁盘进行分区。下面是使用 fdisk 命令对磁盘进行分区的步骤：

1. 首先，使用 fdisk 命令打开要分区的磁盘：
  ```
  sudo fdisk /dev/sdX
  ```
  其中，sdX 表示要分区的磁盘，例如 sda、sdb 等。
2. 然后，输入 m 键查看 fdisk 命令的帮助和选项。
3. 输入 n 命令来创建一个新分区。
4. 会提示你选择分区类型，如果是普通分区请选择 p，如果是扩展分区请选择 e。
5. 然后输入分区号（默认为 1），分配分区开始和结束的扇区编号或使用默认值。
6. 然后分配分区类型（如主分区、扩展分区、逻辑分区）和文件系统类型。
7. 最后，输入 w 命令保存分区表并退出 fdisk。
8. 最后使用 mkfs 命令来创建文件系统。
  ```
  sudo mkfs.ext4 /dev/sdX1
  ```
  其中，sdX1 表示要创建文件系统的分区，例如 sda1、sdb1 等。
完成上述步骤后，您就成功地对磁盘进行了分区。

### 16. linux磁盘设计、LVM、扇区



### 相关命令

``` bash
$ lsblk
$ fdisk
$ /etc/sysconfig/network-scripts
$ dd
$ df -h
$ df -T
$ growpart
$ xfs_growfs
```

[一篇看懂！Linux磁盘的管理（分区、格式化、挂载），LVM逻辑卷，RAID磁盘阵列](https://zhuanlan.zhihu.com/p/296777898)