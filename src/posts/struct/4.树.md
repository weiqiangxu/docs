# 树

### 树的抽象结构就是一棵树，子节点、父节点

### 关键概念

1. 结点的度Degree  -  一个节点拥有的子节点（子树，注意子节点的子节点数量不算在内，节点a的子节点的子节点就不是节点a的子节点）的数量，比如二叉树的度就是2
2. 树的度  -  一棵树中，最大的节点的度称为树的度，什么意思呢，就是每一个节点都有其子节点的数量（这些所有数量之中最大的那个数量就是度）
3. 深度 -  从跟节点往子节点计算，根节点的深度是0，跟节点的子节点的深度是1，根节点的子节点的子节点的深度是2
3. 高度  -  由最外面的叶子节点开始数，树叶的高度是0，树叶的父节点的高度是1
4. 阶Order  -  一个节点的子节点数目的最大值，比如二叉树的阶就是2
5. 关键字  -  每个节点的关键字，你可以认为这个节点是一个存储物理值的变量list，可以存储的关键字就是值
6. 根节点  -  最顶端的节点
7. 父节点
8. 子节点
9. 结点  -  树中的每个点。（有的书中也成为节点）
10. 路径：在一棵树中，一个结点到另一个结点之间的通路，称为路径
11. 路径长度：在一条路径中，每经过一个结点，路径长度都要加 1 
12. 结点的权：给每一个结点赋予一个新的数值，被称为这个结点的权
13. 结点的带权路径长度：指的是从根结点到该结点之间的路径长度与该结点的权的乘积

### 常见的树

1. 二叉树 - 最多有2个子节点的树
2. 满二叉树 - 可以认为是那种叶子节点完整的二叉树，也就是叶子结点都是满的，比如一个根节点和2个子节点的二叉树就是满二叉，叶子节点是对称的，换一句话说是 “叶节点除外的所有节点均含有两个子树的树被称为满二叉树”
3. 完全二叉树 - 如果一颗二叉树除去最后一层节点为满二叉树，且最后一层的结点依次从左到右分布，判断技巧：判断某二叉树是否是完全二叉树的办法，那就是看着树的示意图，心中默默给每个结点按照满二叉树的结构逐层顺序编号，如果编号出现空档，就说明不是完全二叉树，否则就是
4. 二叉查找树 - 比如一个根节点有2个子树，如果左子树所有结点值都小于根节点，右子树所有结点均大于根节点，这种大小有序分布的很方便查找，被称为二叉查找树
5. 有序树 - 任意节点的子结点之间有顺序关系
6. 无序树
7. 霍夫曼树 - 压缩技术起源，当用n个结点构建一棵树，如果这棵树的带权路径长度最小，称这棵树为“最优二叉树”，有时也叫“赫夫曼树”或者“哈夫曼树”，比如3个节点分别带权 1 2 3 构建一个哈夫曼树是怎么样的
8. 平衡二叉树 - 1. 是「二叉排序树」2. 任何一个节点的左子树或者右子树都是「平衡二叉树」（左右高度差小于等于 1）


### 赫夫曼树构建技巧

假设节点有 A1 B2 C3 D4 E5
其中数字是权值

构建过程：
去除最小的2个带权值节点组成树: 生成新节点  F3(A1 B2) (左右由小到大) ， 注意此时节点列表变成了 F3 C3 D4 E5
此时再取出最小2个带权值的节点组成树: 生成新节点 G6(F3 C3)
重复步骤

### 赫夫曼与压缩的理解

假设需要发送 ABBCCCDDDD  这样一段字符串，最简单的就是直接转二进制发送，但想要压缩的话就是 
将出现次数更改为权值，也就是 A1 B2 C3 D4 构建为哈夫曼树以后，将所有左子树更改为0
那么假设一个3节点的满二叉树，左节点为0,右节点为1，就这样可以映射每一个字符，因为赫夫曼权值大的 D 也被提到最上级,用1表示，那么用1111可以表示为DDDD

### 生产环境常见的树

1. B树(又称B-树):  一颗m阶B树，每个子结点数量和每个节点内的关键字数量都有一个规则，属于排序二叉树，结点内存值，这是和B+最大的区别
2. B+树： B+的结点存索引不存数据，数据只存在叶子节点， B+相邻叶子节点通过链表指针连起来的，B+先找到节点，而B+树则需要通过索引找到叶子结点中的数据才结束
3. 红黑树 - 特化的二叉查找树，自平衡二叉查找树，红黑树：根\叶子是黑色的，从根到叶子无2个连续的红色节点

### 用途

B+树一般存储在SSD或者磁盘，树的深度较小，可以减少CPU与磁盘交互时间

红黑树数据一般存在内存之中，数据量小方便查找

### 面试题

##### InnoDB一棵B+树可以存放多少行数据：

2000w行

#####  为什么索引结构默认使用B+树，而不是hash，二叉树，红黑树，B-树：

hash适合等值查找 - 可以认为hash是有一个算法将值和地址有一个特殊计算算法，每一个值都可以快速通过这个算法算出来，所以每一个值的时间复杂度都是一样的，虽然可以快速定位，但是没有顺序，不适合范围查找，即使hash查询某一条数据非常快时间复杂度是O(1)

二叉树 - 树的高度不均匀，不能自平衡，查找效率跟数据有关（树的高度），不稳定

红黑 - 是一种特化的平衡二叉树，MySQL 数据量很大的时候，索引的体积也会很大，内存放不下的而从磁盘读取，树的层次太高的话，读取磁盘的次数就多了

B-树 - 因为B树不管叶子节点还是非叶子节点，都会保存数据，这样导致在非叶子节点中能保存的指针数量变少（有些资料也称为扇出），指针少的情况下要保存大量数据，只能增加树的高度，导致IO操作变多，查询性能变低

IO  -  为什么说IO变多呢因为每次磁盘IO读出的数据量是固定的，B树的叶子节点也存储数据无疑变大增加了IO
区间访问  -  第二个就是B+树所有的Data域在叶子节点，一般来说都会进行一个优化，就是将所有的叶子节点用指针串起来，遍历叶子节点就能获得全部数据，这样就能进行区间访问啦，区间访问也是一个优势

B-树和B+树的区别：

数据存放 - B-树内部节点是保存数据的;而B+树内部节点是不保存数据的，只作索引作用，它的叶子节点才保存数据
叶子结点之间关联 - B+树相邻的叶子节点之间是通过链表指针连起来的，B-树却不是，
关键字 - B-树中任何一个关键字出现且只出现在一个结点中，而B+树可以出现多次


### 参考资料

数据结构教程
http://c.biancheng.net/data_structure/
详解B+
https://zhuanlan.zhihu.com/p/351240279
详解B树
https://blog.csdn.net/weixin_40862011/article/details/85047834
数据结构可视化
https://www.cs.usfca.edu/~galles/visualization/Algorithms.html
索引为啥是B+不默认是B树且不默认是hash
https://blog.csdn.net/weixin_36098377/article/details/108688986
平衡二叉树是撒子
https://blog.csdn.net/jarvan5/article/details/112428036
红黑树与B+树
https://blog.csdn.net/qq_15037231/article/details/103501139
B+原理详解-较浅显易懂
https://www.jianshu.com/p/58562aec3d1c

